
<!DOCTYPE html>
<html>
  <head>
    
<meta charset="utf-8" >

<title>JS中This指向最终释义 | CoderMakers</title>
<meta name="description" content="凉风有信，风月无边">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://codermakers.github.io//favicon.ico?v=1587906961891">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://codermakers.github.io//styles/main.css">



<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



  </head>
  <body>
    <div id="app" class="main">
      <div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://codermakers.github.io/">
        <img class="avatar" src="https://codermakers.github.io//images/avatar.png?v=1587906961891" alt="" width="32px" height="32px">
      </a>
      <a href="https://codermakers.github.io/">
        <h1 class="site-title">CoderMakers</h1>
      </a>
    </div>
    <div class="right">
      <transition name="fade">
        <i class="icon" :class="{ 'icon-close-outline': menuVisible, 'icon-menu-outline': !menuVisible }" @click="menuVisible = !menuVisible"></i>
      </transition>
    </div>
  </div>
</div>

<transition name="fade">
  <div class="menu-container" style="display: none;" v-show="menuVisible">
    <div class="menu-list">
      
        
          <a href="/" class="menu purple-link">
            首页
          </a>
        
      
        
          <a href="/archives" class="menu purple-link">
            归档
          </a>
        
      
        
          <a href="/tags" class="menu purple-link">
            标签
          </a>
        
      
        
          <a href="/post/about" class="menu purple-link">
            关于
          </a>
        
      
    </div>
  </div>
</transition>


      <div class="content-container">
        <div class="post-detail">
          
          <h2 class="post-title">JS中This指向最终释义</h2>
          <div class="post-info post-detail-info">
            <span><i class="icon-calendar-outline"></i> 2020-04-07</span>
            
              <span>
                <i class="icon-pricetags-outline"></i>
                
                  <a href="https://codermakers.github.io/tag/daMu6qTsM/">
                    JS技能修炼
                    
                  </a>
                
              </span>
            
          </div>
          <div class="post-content">
            <h3 id="一-this的指向分类">一、This的指向分类</h3>
<pre><code class="language-js">-1、全局环境下
    无论是否在严格模式下，在全局执行环境中（在任何函数体外部）this 都指向全局对象window。
-2、函数环境下
    在函数内部，this的值取决于函数被调用的方式。this-&gt;执行环境（execution context)对象(非严格模式下,strict模式下,没有EC概念)
</code></pre>
<h3 id="二-细说各种情况下的this指向问题">二、细说各种情况下的This指向问题</h3>
<ul>
<li>2.1 对象打点调用自身方法,this指向该对象</li>
</ul>
<pre><code class="language-js">var people = {
  sayHi() {
    conose.log(this); //this --&gt;people
  }
};
people.sayHi();
</code></pre>
<p>-2.2 DOM绑定事件函数中的this，this指向该DOM对象,本质是隶属于2.1</p>
<pre><code class="language-js">  document.getElementById(&quot;btn&quot;).onclick = function(e){
     console.log(this)   //this--&gt;document.getElementById(&quot;btn&quot;)
  }
  //理解：本身DOM对象下的onclick方法调用
</code></pre>
<p>-2.3 定时器中的callback中的this，this指向window</p>
<pre><code class="language-js">window.setInterval(function() {
    console.log(this);
}, 1000);
window.setTimeout(function() {
    console.log(this);
}, 1000);

//换种写法
function callback(){
   console.log(this);
}
window.setInterval(callback, 1000);
window.setTimeout(callback, 1000);
//理解：setInterval还是setTimeout都是window下的方法，其中的callback也指向window
</code></pre>
<p>-2.4 数组迭代方法中的callback中的this,this指向window</p>
<pre><code class="language-js">//迭代方法
   - forEach(callback)
   - map(callback)
   - filter(callback)
   - every(callback)
   - some(callback)
// 以map为例，callback(迭代器)可以函数名放在全局环境，所以是window；

function evenFn(v,i){
   console.log(this) // this-&gt;window
   return v*2
}
[1,2,3,4].map(evenFn);

//或者
[1,2,3,4].map(v=&gt;v*2)
</code></pre>
<p>-2.5 使用 new 操作符实例化的对象, 构造函数中的this, 原型上方法中的 this,默认指向该实例</p>
<pre><code class="language-js">function Cat(name, age) {
  this.name = name;
  this.age = age;
  this.play = function() {
    console.log(this);
  };
}
Cat.prototype.run = function() {
  console.log(this); //this--&gt;利用构造函数new出的实例对象
};

let Kimi = new Cat(&quot;Kimi&quot;, 3);
Kimi.play();
Kimi.run();
</code></pre>
<ul>
<li>2.6 箭头函数中的this,this指向父级环境对象</li>
</ul>
<pre><code class="language-js">var obj = {
  name:'Kimi',
  run:()=&gt;{
    console.log(this) //this --&gt;window
  }
}
obj.run()
//理解:箭头函数中没有this,会找父级环境中的this.
</code></pre>
<h3 id="三-javascript中如何修改this">三、JavaScript中如何修改this?</h3>
<pre><code class="language-js">function print(){
  console.log('name:' + this.name);
  console.log(arguments)
}
var obj = {
  name:'Jack',
  age:18
}
//调用call
print.call(obj,1,2,3)  // -&gt;逐个传参
//调用apply
print.apply(obj,[1,2,3]) //类数组或者数组传参

// bind绑定this,返回一个函数，必须加()执行
print.bind(obj,[1,2,3])()   //传参形式无限制
/* 
 * 1、 Js中使用bind,call,apply方法可以手动修改this指向,都采用后续传参的形式.
 * 2、区别：
      1、call的传参是单个传递的，而 apply后续传递的参数是(或类数组)数组形式，arguments都是逐个参数的形式,而 bind没有规定，可以传各种值，对象，数组，基本值.
      2、call和 apply函数的执行是直接执行的，而 bind函数会返回一个函数，然后我们想要()调用的时候才会执行。
*/
</code></pre>
<h3 id="四-项目中如何使用this">四、项目中如何使用this?</h3>
<ul>
<li>4.1 保存当前环境对象</li>
</ul>
<pre><code class="language-js">//常以that、_that、_self、context等变量保存this
oBtn.addEventListener(&quot;click&quot;, function() {
  let _self = this; //保存this
  setTimeout(function() {
    alert(_self.innerHTML);
  }, timeout);
});

</code></pre>
<ul>
<li>4.2 作为返回值返回</li>
</ul>
<pre><code class="language-js">var tools = {
  fnA() {
    return this;
  },
  fnB() {
    return this;
  }
  // ...
};
tools.fnA().fnB(); //链式调用
</code></pre>

          </div>
        </div>

        
          <div class="next-post">
            <a class="purple-link" href="https://codermakers.github.io/post/yi-zhang-tu-kan-dong-flex-bu-ju/">
              <h3 class="post-title">
                下一篇：一张图Hold住Flex布局
              </h3>
            </a>
          </div>
          
      </div>

      

      <div class="site-footer">
  <div class="slogan">凉风有信，风月无边</div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://codermakers.github.io//atom.xml" target="_blank">RSS</a>
</div>


    </div>
    <script type="application/javascript">

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>




  </body>
</html>
